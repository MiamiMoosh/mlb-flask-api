import { create } from 'zustand';
import AsyncStorage from '@react-native-async-storage/async-storage';

export const useGlobalStore = create((set, get) => ({
  inventory: [],
  finalMessage: 'ðŸŽŠ Thanks for playing!',
  cardImage: null,
  containerImage: null,

  // INIT â€” Load from storage
  hydrate: async () => {
    const keys = ['inventory', 'finalMessage', 'cardImage', 'containerImage'];
    for (let key of keys) {
      const val = await AsyncStorage.getItem(key);
      if (val) set({ [key]: JSON.parse(val) });
    }
  },

  // Save functions
  setFinalMessage: async (msg) => {
    await AsyncStorage.setItem('finalMessage', JSON.stringify(msg));
    set({ finalMessage: msg });
  },

  setCardImage: async (uri) => {
    await AsyncStorage.setItem('cardImage', JSON.stringify(uri));
    set({ cardImage: uri });
  },

  setContainerImage: async (uri) => {
    await AsyncStorage.setItem('containerImage', JSON.stringify(uri));
    set({ containerImage: uri });
  },

  setInventory: async (list) => {
    await AsyncStorage.setItem('inventory', JSON.stringify(list));
    set({ inventory: list });
  }
}));